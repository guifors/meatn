
<div class="booking-banner" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= @restaurant.image_url %>')">
</div>
<div class="container">
  <div class="row both-columns">

    <div class="col-md-7">
      <div class="info">
        <div class="pb-4">
          <p class="border-bottom details-headline">Booking details</p>
          <p class="pb-0 mb-0"><%= @booking.date %></p>
          <h3 class="pb-0 mb-0 pt-2"><strong><%= @booking.title %></strong></h3>
          <p class="mt-0 pt-2"><%= @booking.description %> </p>
        </div>
        <p class="border-bottom details-headline">Restaurant details</p>
        <h3><%= @booking.restaurant.name %></h3>
        <p><%= @booking.restaurant.address  %></p>
        <div class="d-flex">
         <p><% blank_stars = 5 - @restaurant.user_rating %>
                            <% @restaurant.user_rating.times do  %>
                            <i class="fas fa-star filledstars"></i>
                            <% end %>
                            <% blank_stars.times do %>
                            <i class="far fa-star blankstars"></i>
                            <% end %>
                        (<%= @restaurant.user_reviews %>) </p>

          <% if @restaurant.price == 1 %>
            <p> · $</p>
          <% elsif @restaurant.price == 2 %>
            <p> · $$</p>
          <% else %>
            <p> · $$$</p>
          <% end %>
        </div>
        <div class="d-flex mb-4">
          <p class="mb-0 highlights-text">Highlights:</p>
          <% @booking.restaurant.highlights.gsub(/["]/, '').remove("[").remove("]").split(",").first(4).each do |highlight| %>
            <div class="highlight-tag"> <%= highlight.strip %></div>
          <% end %>
        </div>
        <div class="restaurant-photos container">
        </div>
        <br>
        <p><i class="fas fa-map-marker-alt"></i> <%= @restaurant.short_address %></p>
        <%= image_tag "https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-l(#{@restaurant.longitude},#{@restaurant.latitude})/#{@restaurant.longitude},#{@restaurant.latitude},15/500x300?access_token=pk.eyJ1IjoidG9taHVkc29uODkiLCJhIjoiY2s0MGN4NDJvMDBmZTNlc2Y3YzdheG02ciJ9.CbThae_pau01vd-Br--z3w" %>
      </div>
    </div>
    <div class="col-md-5 info right-column">
      <div class="booking-button-two">
        <% if user_signed_in? %>
          <% if current_user.groups.any? && current_user.groups.find_by(booking: @booking) %>
            <div>
              <div class="signed-up-booking-button">You are attending this event!</div>
              <div class="check-my-bookings">
                <%= link_to "Check my bookings", user_path(current_user) %>
              </div>
            </div>
          <% elsif @booking.full? %>
            <div>Full</div>
          <% elsif current_user == @booking.user %>
            <div class="signed-up-booking-button">You're the host</div>
          <% else %>
              <%= render 'group/form', group: Group.new, booking: @booking %>
          <% end %>
        <% end %>
      </div>
      <p class="border-bottom details-headline pt-4">Attendee list</p>
      <div class="attendees-key-info">
        <div class="attendee-key-info">
          <div class="avatar pt-2">
            <% if @booking.user.photo.attached? %>
              <%= cl_image_tag @booking.user.photo.key, class: "avatar-bordered-card-all-attendees" %>
            <% else %>
              <%= image_tag "default_user.png", class: "avatar-bordered-card-all-attendees" %>
            <% end %>
          </div>
          <div class="attendee-short-details">
            <h5>
              <%= @booking.user.name %> <%= @booking.user.surname %>
            </h5>
            <p>
              <%= @booking.user.age %> years old
            </p>
            <p>
              From <%= @booking.user.location %>
            </p>
          </div>
        </div>
        <% if @booking.users.exists? %>
          <% @booking.users.each do |attendee| %>
            <div class="attendee-key-info">
              <div class="avatar pt-2">
                <% if attendee.photo.attached? %>
                  <%= cl_image_tag attendee.photo.key, class: "avatar-bordered-card-all-attendees" %>
                <% else %>
                  <%= image_tag "default_user.png", class: "avatar-bordered-card-all-attendees" %>
                <% end %>
              </div>
             <div class="attendee-short-details">
                <h5>
                  <%= attendee.name %> <%= attendee.surname %>
                </h5>
                <p>
                  <%= attendee.age %> years old
                </p>
                <p>
                  From <%= attendee.location %>
                </p>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
      <p class="border-bottom details-headline pt-5">Comments</p>
      <% if @booking.comments != nil %>
        <% @booking.comments.each do |comment| %>
        <div class="comment d-flex pt-3">
          <%= cl_image_tag comment.user.photo.key, class: "ml-1 avatar-bordered-card", alt: "avatar-bordered-card" %>
          <div class="comment-space">
            <p class="comment-owner"><%= comment.user.name %> <%= comment.user.surname %> says:</p>
            <p><%= comment.content %></p>
          </div>
        </div>
        <% end %>
      <% end %>
      <div class="details mt-4">
        <%= simple_form_for( [@booking, @comment], remote: true) do |f| %>
          <%= f.input :content, label: false, placeholder: "Add your comment" %>
          <div class="d-flex flex-row-reverse">
            <%= f.submit "Add", class: "btn btn-light" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<br>
<br>
<%= render 'shared/footer' %>
